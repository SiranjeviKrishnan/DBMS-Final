CREATE DATABASE Olympics_21274501;
USE Olympics_21274501;

CREATE TABLE Countries (
    CountryID INT PRIMARY KEY,
    CountryName VARCHAR(100) NOT NULL
);

CREATE TABLE Venues (
    VenueID INT PRIMARY KEY,
    VenueName VARCHAR(100) NOT NULL,
    Location VARCHAR(100)
);

CREATE TABLE Athletes (
    AthleteID INT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    DateOfBirth DATE,
    CountryID INT,
    FOREIGN KEY (CountryID) REFERENCES Countries(CountryID)
);

CREATE TABLE Events (
    EventID INT PRIMARY KEY,
    EventName VARCHAR(100) NOT NULL,
    SportType VARCHAR(50),
    VenueID INT,
    FOREIGN KEY (VenueID) REFERENCES Venues(VenueID)
);

CREATE TABLE Results (
    ResultID INT PRIMARY KEY,
    AthleteID INT,
    EventID INT,
    MedalType ENUM('Gold', 'Silver', 'Bronze'),
    FOREIGN KEY (AthleteID) REFERENCES Athletes(AthleteID),
    FOREIGN KEY (EventID) REFERENCES Events(EventID)
);

INSERT INTO Countries (CountryID, CountryName) VALUES
(1, 'United States'),
(2, 'Canada'),
(3, 'Germany'),
(4, 'France'),
(5, 'Italy');

INSERT INTO Venues (VenueID, VenueName, Location) VALUES
(1, 'Olympic Stadium', 'Tokyo, Japan'),
(2, 'Olympic Aquatics Centre', 'Tokyo, Japan'),
(3, 'Olympic Gymnastics Centre', 'Tokyo, Japan'),
(4, 'Olympic Velodrome', 'Tokyo, Japan'),
(5, 'Olympic Tennis Centre', 'Tokyo, Japan');

INSERT INTO Athletes (AthleteID, Name, DateOfBirth, CountryID) VALUES
(1, 'Michael Phelps', '1985-06-30', 1),
(2, 'Simone Biles', '1997-03-14', 1),
(3, 'Usain Bolt', '1986-08-21', 3),
(4, 'Penny Oleksiak', '2000-06-13', 2),
(5, 'Marcel Hirscher', '1989-03-02', 3);

INSERT INTO Events (EventID, EventName, SportType, VenueID) VALUES
(1, '100m Freestyle', 'Swimming', 2),
(2, 'Gymnastics All-Around', 'Gymnastics', 3),
(3, '100m Sprint', 'Athletics', 1),
(4, 'Downhill Skiing', 'Skiing', 4),
(5, 'Tennis Singles', 'Tennis', 5);

INSERT INTO Results (ResultID, AthleteID, EventID, MedalType) VALUES
(1, 1, 1, 'Gold'),
(2, 2, 2, 'Gold'),
(3, 3, 3, 'Gold'),
(4, 4, 1, 'Silver'),
(5, 5, 4, 'Bronze');

// Query to find all athletes who won gold medals
SELECT a.Name AS AthleteName, e.EventName
FROM Athletes a
JOIN Results r ON a.AthleteID = r.AthleteID
JOIN Events e ON r.EventID = e.EventID
WHERE r.MedalType = 'Gold';

// Query to get medal counts by country
SELECT c.CountryName, r.MedalType, COUNT(*) AS MedalCount
FROM Results r
JOIN Athletes a ON r.AthleteID = a.AthleteID
JOIN Countries c ON a.CountryID = c.CountryID
GROUP BY c.CountryName, r.MedalType;


//Stored Procedure
DELIMITER //
CREATE PROCEDURE GetMedalCount(IN countryName VARCHAR(100))
BEGIN
    SELECT MedalType, COUNT(*) AS Count
    FROM Results r
    JOIN Athletes a ON r.AthleteID = a.AthleteID
    JOIN Countries c ON a.CountryID = c.CountryID
    WHERE c.CountryName = countryName
    GROUP BY MedalType;
END //
DELIMITER ;



